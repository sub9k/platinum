-- Load Kavo UI Library
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"))()
local Window = Library.CreateLib("Egg Automation Script", "DarkTheme")

-- Create Egg Automation Tab & Section
local EggTab = Window:NewTab("Egg Automation")
local EggSection = EggTab:NewSection("Auto Egg Process")

-- State variables
local autoEgg = false
local selectedEgg = "Zen Egg" -- fixed name

-- Notification function
local function notify(msg)
    pcall(function()
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "Egg Automation",
            Text = msg,
            Duration = 2
        })
    end)
end

-- Toggle logic
EggSection:NewDropdown("Select Egg", "Select the egg to automate", {"Zen Egg"}, function(option)
    selectedEgg = option
end)

EggSection:NewToggle("Run Egg Automation", "Equips and processes selected egg continuously", function(state)
    autoEgg = state

    task.spawn(function()
        while autoEgg do
            notify("Equipping: " .. selectedEgg)
            -- Equip tool
            local player = game.Players.LocalPlayer
            local backpack = player:WaitForChild("Backpack")
            local character = player.Character or player.CharacterAdded:Wait()

            local tool = backpack:FindFirstChild(selectedEgg)
            if tool then
                tool.Parent = character
            end

            -- Step 1: CreateEgg 8 times
            for i = 1, 8 do
                local args = {
                    "CreateEgg",
                    vector.create(60.230186462402344, 0.1754859983921051, -112.32734680175781)
                }
                game:GetService("ReplicatedStorage"):WaitForChild("GameEvents"):WaitForChild("PetEggService"):FireServer(unpack(args))
                task.wait(0.1)
            end
            notify("Created 8 eggs")

            -- Step 2: AuthorisePurchase for each PetEgg
            local petEggs = {}
            local farmPath = workspace:WaitForChild("Farm"):WaitForChild("Farm"):WaitForChild("Important"):WaitForChild("Objects_Physical")
            for _, obj in ipairs(farmPath:GetChildren()) do
                if obj.Name == "PetEgg" then
                    table.insert(petEggs, obj)
                end
            end

            for _, egg in ipairs(petEggs) do
                local args = {
                    "AuthorisePurchase",
                    egg
                }
                game:GetService("ReplicatedStorage"):WaitForChild("GameEvents"):WaitForChild("PetEggService"):FireServer(unpack(args))
                task.wait(0.1)
            end
            notify("Authorised " .. #petEggs .. " eggs")

            -- Step 3: HatchPet for each PetEgg
            for _, egg in ipairs(petEggs) do
                local args = {
                    "HatchPet",
                    egg
                }
                game:GetService("ReplicatedStorage"):WaitForChild("GameEvents"):WaitForChild("PetEggService"):FireServer(unpack(args))
                task.wait(0.1)
            end
            notify("Hatched " .. #petEggs .. " eggs")

            task.wait(1) -- small wait before next loop
        end
    end)
end)
